#!/bin/bash

# Trivy Scanner Example Usage
# Demonstrates various scanning scenarios using the Python script

echo "=== Trivy Scanner Examples ==="
echo

# Check if the Python script exists
if [ ! -f "trivy_scanner.py" ]; then
    echo "Error: trivy_scanner.py not found in current directory"
    exit 1
fi

# Make sure it's executable
chmod +x trivy_scanner.py

echo "1. Quick comprehensive scan (recommended for regular security checks)"
echo "   Command: ./trivy_scanner.py quick --severity HIGH,CRITICAL"
echo "   This will:"
echo "   - Scan any SSH jump server Docker images"
echo "   - Scan the current repository for vulnerabilities and secrets"
echo "   - Scan configuration files for misconfigurations"
echo "   - Create .trivyignore from template if missing"
echo

echo "2. Scan a specific Docker image"
echo "   Command: ./trivy_scanner.py image nginx:latest"
echo "   Command: ./trivy_scanner.py image --severity CRITICAL ubuntu:20.04"
echo

echo "3. Scan current repository/directory"
echo "   Command: ./trivy_scanner.py repo"
echo "   Command: ./trivy_scanner.py repo /path/to/your/go-project"
echo "   Command: ./trivy_scanner.py repo --ignore-unfixed"
echo

echo "4. Scan configuration files for misconfigurations"
echo "   Command: ./trivy_scanner.py config"
echo "   Command: ./trivy_scanner.py config /path/to/k8s/manifests"
echo

echo "5. Real examples for your Go/Next.js/Python stack:"
echo
echo "   # Scan Go project"
echo "   ./trivy_scanner.py repo /path/to/go-service --severity HIGH,CRITICAL"
echo
echo "   # Scan Next.js application"
echo "   ./trivy_scanner.py repo /path/to/nextjs-app --ignore-unfixed"
echo
echo "   # Scan Python service"
echo "   ./trivy_scanner.py repo /path/to/python-api"
echo
echo "   # Scan Docker images you've built"
echo "   ./trivy_scanner.py image your-go-service:latest"
echo "   ./trivy_scanner.py image your-nextjs-app:latest"
echo "   ./trivy_scanner.py image your-python-api:latest"
echo

echo "=== Output Locations ==="
echo "- Scan reports: ./security-reports/"
echo "- Logs: ./logs/trivy-scan.log"
echo "- .trivyignore: Created in target directories from trivyignore-template"
echo

echo "=== Quick Start ==="
echo "Run this command to start scanning immediately:"
echo "./trivy_scanner.py quick"
echo