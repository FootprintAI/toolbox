# Code Vulnerability Scanner Toolbox

A comprehensive vulnerability scanning solution for Go/Next.js/Python applications using Docker-based tools.

## ğŸ”§ Tools Included

### **Trivy** - Dependency & Container Vulnerability Scanner
- **Purpose**: Scans dependencies, container images, and configurations
- **Finds**: Known CVEs in packages, container vulnerabilities, misconfigurations
- **Best for**: CI/CD pipelines, dependency audits, container security

### **Semgrep** - Static Code Analysis Scanner  
- **Purpose**: Scans source code for security vulnerabilities
- **Finds**: SQL injection, XSS, hardcoded secrets, code injection, OWASP Top 10
- **Best for**: Code reviews, security audits, finding actual code vulnerabilities

## ğŸ“ File Structure

```
code-vulnerability-scanner/
â”œâ”€â”€ README.md                    # This file
â”œâ”€â”€ trivy_scanner.py            # Trivy dependency scanner
â”œâ”€â”€ trivyignore-template        # Trivy ignore patterns for Go/JS/Python
â”œâ”€â”€ trivy-examples.sh           # Trivy usage examples
â”œâ”€â”€ semgrep_scanner.py          # Semgrep source code scanner
â”œâ”€â”€ semgrep-custom-rules.yml    # Custom security rules for your stack
â”œâ”€â”€ semgrep-examples.sh         # Semgrep usage examples
â”œâ”€â”€ logs/                       # Scan logs
â””â”€â”€ security-reports/           # Generated reports
```

## ğŸš€ Quick Start

### Trivy (Dependencies & Containers)
```bash
# Quick dependency scan
./trivy_scanner.py quick

# Scan specific repository  
./trivy_scanner.py repo /path/to/project --severity HIGH,CRITICAL

# Scan Docker image
./trivy_scanner.py image nginx:latest
```

### Semgrep (Source Code)
```bash
# Comprehensive source code scan
./semgrep_scanner.py comprehensive /path/to/project

# Security-focused scan
./semgrep_scanner.py security /path/to/project --severity ERROR

# Language-specific scan
./semgrep_scanner.py language /path/to/go-code --lang go
```

## ğŸ“Š Output & Reports

Both tools generate reports in multiple formats:
- **JSON** - For automation and CI/CD integration
- **SARIF** - For GitHub Security tab integration
- **Text/Table** - Human-readable reports

Reports are saved to: `./security-reports/`
Logs are saved to: `./logs/`

## ğŸ¯ Use Cases

| Scenario | Tool | Command |
|----------|------|---------|
| **Pre-deployment security check** | Both | Run both comprehensive scans |
| **Dependency audit** | Trivy | `./trivy_scanner.py repo` |
| **Code review security** | Semgrep | `./semgrep_scanner.py security` |
| **Container security** | Trivy | `./trivy_scanner.py image` |
| **Find hardcoded secrets** | Semgrep | `./semgrep_scanner.py language --lang python` |
| **OWASP Top 10 check** | Semgrep | `./semgrep_scanner.py comprehensive` |

## âš™ï¸ Configuration

### Trivy Configuration
- **Ignore file**: `trivyignore-template` - Framework-specific ignore patterns
- **Auto-deployment**: Script creates `.trivyignore` in target directories

### Semgrep Configuration  
- **Custom rules**: `semgrep-custom-rules.yml` - Security rules for Go/JS/Python
- **Built-in rulesets**: `p/security-audit`, `p/golang`, `p/javascript`, etc.

## ğŸ” What Each Tool Finds

### Trivy Detects:
âœ… CVEs in npm packages  
âœ… Vulnerabilities in Go modules  
âœ… Python package security issues  
âœ… Container image vulnerabilities  
âœ… Dockerfile misconfigurations  
âœ… Infrastructure as Code issues  

### Semgrep Detects:
âœ… SQL injection vulnerabilities  
âœ… Cross-site scripting (XSS)  
âœ… Hardcoded API keys/passwords  
âœ… Code injection (eval, exec)  
âœ… Weak cryptography usage  
âœ… Prototype pollution (JavaScript)  
âœ… Unsafe deserialization  
âœ… OWASP Top 10 vulnerabilities  

## ğŸ³ Docker Requirements

Both tools require Docker to be installed and running. They use official Docker images:
- **Trivy**: `aquasec/trivy:latest`
- **Semgrep**: `returntocorp/semgrep:latest`

## ğŸ“‹ Examples

See the example scripts for detailed usage:
- `./trivy-examples.sh` - Trivy usage examples
- `./semgrep-examples.sh` - Semgrep usage examples

## ğŸ”§ Integration

### CI/CD Integration
Both tools output SARIF format for GitHub Security tab integration:
```bash
# Generate SARIF reports for GitHub
./semgrep_scanner.py security /path/to/code --severity ERROR
./trivy_scanner.py repo /path/to/code --severity HIGH,CRITICAL
```

### Pre-commit Hooks
Add to `.pre-commit-config.yaml`:
```yaml
repos:
  - repo: local
    hooks:
      - id: security-scan
        name: Security Scan
        entry: ./code-vulnerability-scanner/semgrep_scanner.py security . --severity ERROR
        language: system
        pass_filenames: false
```

## ğŸ“ˆ Best Practices

1. **Run both tools** - They complement each other (dependencies + source code)
2. **Use appropriate severity levels** - ERROR for production, WARNING for development
3. **Review ignore patterns** - Customize ignore files for your specific needs
4. **Integrate into CI/CD** - Automate scanning in your pipeline
5. **Regular scanning** - Run weekly dependency scans, daily code scans